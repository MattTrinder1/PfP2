"Scr_identification As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    OnHidden: |-
        =Reset(PenInput3);
        UpdateContext({canvasVisible:false})
    OnVisible: |-
        =UpdateContext({canvasVisible: true});
        Set(
            addcontactmethod,
            false
        );
        UpdateContext({addcontactmethod: false});
        Set(
            contactworkphone,
            false
        );
        UpdateContext({contactworkphone: false});
        Set(
            contactmail,
            false
        );
        UpdateContext({contactmail: false});
        Set(
            contacthomephone,
            false
        );
        UpdateContext({contacthomephone: false});
        Set(
            contactmobile,
            false
        );
        UpdateContext({contactmobile: false});
        Set(
            occupation,
            false
        );
        UpdateContext({occupation: false});
        Set(
            ycontactmethodid,
            0
        );
        Set(
            yretiredid,
            0
        );
        If(
            !IsBlank(Txt_steps_to_identify_1.Text),
            Set(
                MadcolNo,
                White
            ),
            Set(
                MadcolNo,
                LightGoldenRodYellow
            )
        );
        UpdateContext({y1: 0});
        Set(
            madcol,
            LightGoldenRodYellow
        );
        UpdateContext({madcol: LightGoldenRodYellow});
        Set(
            madcolA,
            LightGoldenRodYellow
        );
        UpdateContext({madcolA: LightGoldenRodYellow});
        Set(
            madcolB,
            LightGoldenRodYellow
        );
        UpdateContext({madcolB: LightGoldenRodYellow});
        Set(
            madcolC,
            LightGoldenRodYellow
        );
        UpdateContext({madcolC: LightGoldenRodYellow});
        Set(
            madcolD,
            LightGoldenRodYellow
        );
        UpdateContext({madcolD: LightGoldenRodYellow});
        Set(
            madcolE,
            LightGoldenRodYellow
        );
        UpdateContext({madcolE: LightGoldenRodYellow});
        Set(
            madcolF,
            LightGoldenRodYellow
        );
        UpdateContext({madcolF: LightGoldenRodYellow});
        Set(
            madcolF,
            LightGoldenRodYellow
        );
        UpdateContext({madcolF: LightGoldenRodYellow});
        Set(
            madcolG,
            LightGoldenRodYellow
        );
        UpdateContext({madcolG: LightGoldenRodYellow});
        Set(
            madcolH,
            LightGoldenRodYellow
        );
        UpdateContext({madcolH: LightGoldenRodYellow});
        Set(
            madcolI,
            LightGoldenRodYellow
        );
        UpdateContext({madcolI: LightGoldenRodYellow});
        Set(
            madcolJ,
            LightGoldenRodYellow
        );
        UpdateContext({madcolJ: LightGoldenRodYellow});
        Set(
            madcolK,
            LightGoldenRodYellow
        );
        UpdateContext({madcolK: LightGoldenRodYellow});
        Set(
            madcolL,
            LightGoldenRodYellow
        );
        UpdateContext({madcolL: LightGoldenRodYellow});
        Set(
            madcolM,
            LightGoldenRodYellow
        );
        UpdateContext({madcolM: LightGoldenRodYellow});
        Set(
            madcolM,
            LightGoldenRodYellow
        );
        UpdateContext({madcolM: LightGoldenRodYellow});
        Set(
            madcolN,
            LightGoldenRodYellow
        );
        UpdateContext({madcolN: LightGoldenRodYellow});
        Set(
            madcolO,
            LightGoldenRodYellow
        );
        UpdateContext({madcolO: LightGoldenRodYellow});
        Set(
            madcolsidd,
            LightGoldenRodYellow
        );
        UpdateContext({madcolsidd: LightGoldenRodYellow});
        If(
            Len(txtDeceasedOccupation_identification.Text) > 0,
            UpdateContext({madcolsidd: Transparent}),
            UpdateContext({madcolsidd: LightGoldenRodYellow})
        );
        Set(
            ResetAll,
            true
        );
        Set(
            Allreset,
            true
        );
        Set(
            overLayVisible,
            false
        );
        If(
            LookUp(
                Contactoffline,
                Key = Drpdn_incident_key_2.Selected.Key And (Contactrolename = "Identifier" Or Contactrolename = "Deceased")
            ).identificationsignature <> Blank(),
            Set(
                idetidisable,
                DisplayMode.Disabled
            )
        );
        //If(Len(LookUp('Contact offline',Key=Drpdn_incident_key_2.Selected.Key And Contactrolename="Identifier").identificationsignature)>0  ,Set(idetidisable,DisplayMode.Disabled),Set(idetidisable,DisplayMode.Edit));
        /*If(LookUp('Contact offline',Key=Drpdn_incident_key_2.Selected.Key).identificationsignature <> imgBlank.Image,Set(idetidisable,DisplayMode.Disabled));*/Set(
            varInitialPenInput,
            PenInput3.Image
        );
        Set(
            varPenInput,
            PenInput3.Image
        );
        UpdateContext({hasBeenSigned: true});
        
        If(
            LookUp(
                Contactoffline,
                Key = Drpdn_incident_key_2.Selected.Key,
                identificationsignature
            ) = Blank(),
            UpdateContext({hasBeenSigned: false})
        )

    RectQuickActionBar_header_2 As rectangle:
        Height: =88
        Width: =Parent.Width
        ZIndex: =1

    Lbl_header_details_2 As label:
        Align: =Align.Center
        Fill: =RGBA(153, 153, 153, 1)
        FontWeight: =FontWeight.Bold
        Height: =88
        Size: =27
        Text: |
            ="Identification" //& hasBeenSigned//& IsEmpty(LookUp(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key  And Contactrolename = "Identifier")) & CountRows(LookUp(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key  And Contactrolename = "Identifier"))
        Width: =Parent.Width
        ZIndex: =2

    Canvas_details_2 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Fill: =Transparent
        Height: =939
        Visible: =canvasVisible
        Width: =Parent.Width
        Y: =RectQuickActionBar_header_2.Y + RectQuickActionBar_header_2.Height
        ZIndex: =3

        DataCard_details_scroll_2 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =3421
            Visible: =Radio_Identification_completion_1.SelectedText.Value="Yes"
            Width: =640
            X: =0
            Y: =2
            ZIndex: =1

            DatePicker_dob_1 As datepicker:
                BorderColor: =RGBA(153, 153, 153, 1)
                DefaultDate: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).'Date of Birth'
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.SelectedDate),LightGoldenRodYellow,White)
                Height: =68
                IconBackground: =RGBA(128, 128, 128, 100)
                InputTextPlaceholder: ="DD/MM/YYYY"
                IsEditable: =true
                OnChange: |-
                    =If (DatePicker_dob_1.SelectedDate >0,UpdateContext({madcolD:Transparent}),UpdateContext({madcolD:LightGoldenRodYellow}))
                OnSelect: |-
                    =If(IsBlank(DatePicker_dob_1),
                        UpdateContext({madcolD: LightGoldenRodYellow}),
                        UpdateContext({madcolD: Transparent })
                    );
                    
                    //remember to change madcol
                Reset: =Allreset
                Size: =24
                StartYear: =1900
                Width: =545
                X: =40
                Y: =412
                ZIndex: =4

            Label_dob_2 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Date of birth"
                Width: =545
                X: =40
                Y: =352
                ZIndex: =5

            Txt_houseno_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Housenumber
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                HintText: =""
                OnChange: =
                OnSelect: =
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =666
                ZIndex: =7

            Txt_address_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Address1
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                OnChange: |-
                    =If(
                        Len(Txt_address_1.Text) > 0,
                        UpdateContext({madcolE: Transparent}),
                        UpdateContext({madcolE: LightGoldenRodYellow})
                    );
                OnSelect: |-
                    =If(
                        Len(Txt_address_1.Text)>0,
                        UpdateContext({madcolE: Transparent}),
                        UpdateContext({madcolE: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =766
                ZIndex: =8

            Txt_district_2 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).District
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                HintText: =""
                OnChange: =
                OnSelect: =
                Size: =21
                Width: =545
                X: =40
                Y: =866
                ZIndex: =9

            Txt_town_2 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Town
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                OnChange: |
                    =If(
                        Len(Txt_town_2.Text) > 0,
                        UpdateContext({madcolG: Transparent}),
                        UpdateContext({madcolG: LightGoldenRodYellow})
                    );
                OnSelect: |-
                    =If(Len(Txt_town_2.Text)>0,UpdateContext({madcolE:Transparent}),
                    UpdateContext({madcolE:LightGoldenRodYellow}))
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =966
                ZIndex: =10

            Txt_pobox_2 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).pcode
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                OnChange: |-
                    =If(
                        Len(Txt_pobox_2.Text) > 0,
                        UpdateContext({madcolI: Transparent}),
                        UpdateContext({madcolI: LightGoldenRodYellow})
                    );
                    If(Txt_pobox_2.Text=Upper(Txt_pobox_2.Text),Green,Reset(Txt_pobox_2));
                OnSelect: |-
                    =If(
                        Len(Txt_pobox_2.Text) > 0,
                        UpdateContext({madcolI: Transparent}),
                        UpdateContext({madcolI: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Tooltip: ="Only Upper case allowed"
                Width: =545
                X: =40
                Y: =1185
                ZIndex: =11

            Txt_county_2 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).County
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                OnChange: |
                    =If(
                        Len(Txt_county_2.Text) > 0,
                        UpdateContext({madcolJ: Transparent}),
                        UpdateContext({madcolJ: LightGoldenRodYellow})
                    );
                OnSelect: |
                    =If(
                        Len(Txt_county_2.Text) > 0,
                        UpdateContext({madcolJ: Transparent}),
                        UpdateContext({madcolJ: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =36
                Y: =1071
                ZIndex: =12

            Drpdn_pref_contact_method_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(128, 128, 128, 1)
                ChevronBackground: =RGBA(128, 128, 128, 1)
                ChevronHoverBackground: =ColorFade(RGBA(230, 230, 230, 100), -20%)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Preferedcontactmethodname
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.SelectedText.Value),LightGoldenRodYellow,White)
                Height: =68
                HoverFill: =RGBA(230, 230, 230, 1)
                Items: =contactmethodoffline
                OnChange: =
                OnSelect: |
                    =
                PressedFill: =RGBA(230, 230, 230, 1)
                Reset: =Allreset
                SelectionFill: =RGBA(128, 128, 128, 1)
                Size: =21
                Width: =545
                X: =40
                Y: =2025
                ZIndex: =14

            Lbl_preferedcontactmethod_1 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Preferred contact method"
                Width: =530
                X: =40
                Y: =1963
                ZIndex: =15

            Label_retired_1 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =64
                Size: =21
                Text: |-
                    ="Retired?
                    "
                Width: =560
                X: =40
                Y: =2094
                ZIndex: =16

            Radio_retired_1 As radio:
                BorderStyle: =BorderStyle.None
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Retired
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.SelectedText.Value),LightGoldenRodYellow,White)
                Height: =94
                Items: =["Yes","No"]
                Layout: =Layout.Horizontal
                OnChange: |-
                    =UpdateContext({visibletag:true})
                OnSelect: |-
                    =If(
                        Radio_retired_1.Selected.Value = "Yes",
                        UpdateContext({occupation: true});UpdateContext({occupation1: false}));
                        If(
                        Radio_retired_1.Selected.Value = "No",
                        UpdateContext({occupation: false});UpdateContext({occupation1: true}));
                RadioBorderColor: =RGBA(128, 128, 128, 1)
                Reset: =Allreset
                Size: =21
                Width: =335
                X: =40
                Y: =2157
                ZIndex: =17

            Txt_additional_information_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Additionalinfo
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                HintText: ="Additional information"
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                HoverFill: =RGBA(230, 230, 230, 1)
                OnChange: =
                OnSelect: =
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =2427
                ZIndex: =18

            Txt_deceased_relathionship_duration_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Deceasedrelationshipduration
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                HoverFill: =RGBA(230, 230, 230, 1)
                OnChange: |
                    =If(
                        Len(Txt_deceased_relathionship_duration_1.Text) > 0,
                        UpdateContext({madcolM: Transparent}),
                        UpdateContext({madcolM: LightGoldenRodYellow})
                    );
                OnSelect: |
                    =If(
                        Len(Txt_deceased_relathionship_duration_1.Text)>0,
                        UpdateContext({madcolM: Transparent}),
                        UpdateContext({madcolM: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =2561
                ZIndex: =19

            Label_former_occupation_3 As label:
                Height: =68
                Size: =21
                Text: ="Former Occupation"
                Visible: =occupation
                Width: =545
                X: =40
                Y: =2262
                ZIndex: =20

            Txt_relationship_deceased_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Deceasedrelathionship
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                OnChange: |
                    =If(
                        Len(Txt_relationship_deceased_1.Text) > 0,
                        UpdateContext({madcolN: Transparent}),
                        UpdateContext({madcolN: LightGoldenRodYellow})
                    );
                OnSelect: |
                    =If(
                        Len(Txt_relationship_deceased_1.Text) > 0,
                        UpdateContext({madcolN: Transparent}),
                        UpdateContext({madcolN: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =2712
                ZIndex: =21

            Label_former_occupation_5 As label:
                DisplayMode: =//If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: =If(Radio_retired_1.SelectedText.Value = "Yes","Former occupation","Occupation")
                Visible: =occupation1
                Width: =545
                X: =43
                Y: =2258
                ZIndex: =22

            Label_deceased_relathionship_7 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =64
                Size: =21
                Text: |-
                    ="How long known deceased?
                    "
                Width: |
                    =530
                X: =40
                Y: =2508
                ZIndex: =24

            Label_deceased_relathionship_8 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =64
                Size: =21
                Text: ="Relationship to deceased"
                Width: |
                    =530
                X: =40
                Y: =2651
                ZIndex: =25

            Lbl_addcontactmethod_2 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Add contact method"
                Width: =535
                X: =40
                Y: =1352
                ZIndex: =26

            Lbl_address_18 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Additional address info"
                Width: =560
                X: =43
                Y: =610
                ZIndex: =38

            Lbl_address_19 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Street"
                Width: =560
                X: =40
                Y: =711
                ZIndex: =39

            Lbl_address_20 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="District"
                Width: =560
                X: =40
                Y: =816
                ZIndex: =40

            Lbl_address_21 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Town"
                Width: =560
                X: =40
                Y: =911
                ZIndex: =41

            Lbl_address_22 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="County"
                Width: =560
                X: =40
                Y: =1014
                ZIndex: =42

            Lbl_address_23 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =68
                Size: =21
                Text: ="Post Code"
                Width: =560
                X: =40
                Y: =1128
                ZIndex: =43

            Lbl_address_24 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =49
                Size: =21
                Text: ="Country"
                Width: =560
                X: =40
                Y: =1245
                ZIndex: =44

            txtDeceasedOccupation_identification As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Formeroccupationname
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =madcolsidd
                Height: =68
                HintText: =""
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                HoverFill: =RGBA(230, 230, 230, 1)
                OnChange: |-
                    =If(Len(txtDeceasedOccupation_identification.Text)>0,UpdateContext({madcolsidd:Transparent}),UpdateContext({madcolsidd:LightGoldenRodYellow}))
                OnSelect: |-
                    =If(Len(txtDeceasedOccupation_identification.Text)>0,UpdateContext({madcolsidd:Transparent}),UpdateContext({madcolsidd:LightGoldenRodYellow}))
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =40
                Y: =2318
                ZIndex: =45

            Label1 As label:
                Height: =70
                Size: =21
                Text: ="Signature Date"
                Width: =560
                X: =44
                Y: =3271
                ZIndex: =48

            Txt_relationship_location_id As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Locationofid
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                OnChange: |
                    =If(
                        Len(Txt_relationship_location_id.Text) > 0,
                        UpdateContext({madcolO: Transparent}),
                        UpdateContext({madcolO: LightGoldenRodYellow})
                    );
                OnSelect: |
                    =If(
                        Len(Txt_relationship_location_id.Text) > 0,
                        UpdateContext({madcolO: Transparent}),
                        UpdateContext({madcolO: LightGoldenRodYellow})
                    );
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =45
                Y: =2831
                ZIndex: =50

            Label_deceased_relathionship_9 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =64
                Size: =21
                Text: ="Location of identification"
                Width: |
                    =530
                X: =40
                Y: =2779
                ZIndex: =51

            Txt_identifier_sign_date_time As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                Default: |-
                    =If(hasBeenSigned = true And IsBlank(First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).signdate),Text(DateNow,"[$-en-GB]dd/mm/yyyy hh:mm:ss"),First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).signdate)
                DisplayMode: =DisplayMode.Disabled
                Fill: =If (IsBlank(Self.Text), LightGoldenRodYellow,White)
                Height: =68
                HintText: =""
                OnChange: =
                OnSelect: =
                Reset: =Allreset
                Size: =21
                Width: =545
                X: =43
                Y: =3328
                ZIndex: =52

            Coombobox_country_2 As dropdown:
                BorderColor: =RGBA(116, 116, 116, 1)
                ChevronBackground: =RGBA(116, 116, 116, 1)
                Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Country
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.Selected.cp_name),LightGoldenRodYellow,White)
                Height: =70
                Items: =SortByColumns( countriesoffline,"cp_displaysequenceno",Ascending,"cp_name",Descending)
                OnChange: |-
                    =
                    If(Len(Text(Coombobox_country_2.Selected.cp_name))>0,UpdateContext({madcolH:White}),UpdateContext({madcolH:LightGoldenRodYellow}));
                Reset: =Allreset
                SelectionFill: =RGBA(116, 116, 116, 1)
                Size: =21
                Width: =549
                X: =43
                Y: =1295
                ZIndex: =53

            Group9 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =57

                Label11_1 As label:
                    Height: =68
                    OnSelect: =
                    Size: =21
                    Text: |-
                        ="Signed:"
                    Width: =560
                    X: =40
                    Y: =2951
                    ZIndex: =46

                Label11 As label:
                    Height: =68
                    OnSelect: =
                    Size: =21
                    Text: ="I can confirm that I have made the identification of the above named person"
                    Width: =560
                    X: =40
                    Y: =2894
                    ZIndex: =47

                Image_identification_signature As image:
                    BorderColor: =RGBA(149, 149, 149, 1)
                    BorderThickness: =2
                    Height: =280
                    Image: =LookUp(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key And LookUp('Sudden death offline',Key=Drpdn_incident_key_2.Selected.Key).IdentifierContactKey in ContactKey).identificationsignature
                    ImagePosition: =ImagePosition.Stretch
                    Visible: |-
                        =LookUp(
                            Contactoffline,
                            Key = Drpdn_incident_key_2.Selected.Key,
                            identificationsignature
                        ) <> Blank()
                    Width: =541
                    X: =47
                    Y: =3005
                    ZIndex: =49

                PenInput3 As inkControl:
                    DisplayMode: |-
                        =If(
                            Radio_Identification_completion_1.Selected.Value = "Yes" And Len(Drpdn_title_2.Selected.cp_name) > 0 And !IsBlank(Txt_forename_1.Text) And !IsBlank(Txt_surname_1.Text) And !IsBlank(Text(DatePicker_dob_1.SelectedDate)) And !IsBlank(Txt_housename_1.Text) And !IsBlank(Txt_address_1.Text) And !IsBlank(Txt_town_2.Text) And !IsBlank(Txt_county_2.Text) And !IsBlank(Txt_pobox_2.Text) And !IsBlank(Coombobox_country_2.Selected.cp_name) And (!IsBlank(Txt_homeph_4.Text) Or !IsBlank(Txt_workphone_4.Text) Or !IsBlank(Txt_mobileph_4.Text) Or !IsBlank(Txt_mail_4.Text)) And !IsBlank(Drpdn_pref_contact_method_1.Selected.cp_name) And !IsBlank(Radio_retired_1.Selected.Value) And !IsBlank(Txt_deceased_relathionship_duration_1.Text) And !IsBlank(Txt_relationship_deceased_1.Text) And !IsBlank(Txt_relationship_location_id)
                            //And Image_identification_signature.Image = SampleImage 
                            
                        And LookUp(
                                Contactoffline,
                                Key = Drpdn_incident_key_2.Selected.Key,
                                identificationsignature
                            ) = Blank() And Len(Txt_Deceased_detailsforename.Text) > 0 And Len(Txt_Deceased_details_surname.Text) > 0 And Len(Text(Datepicker_Deceased_details_dob.SelectedDate)) > 0 And Len(Txt_Deceased_details_address.Text) > 0 And Len(Txt_Deceased_details_housename.Text) > 0 And Len(Txt_Deceased_details_town.Text) > 0 And Len(Txt_Deceased_details_county.Text) > 0 And Len(Txt_Deceased_details_pobox.Text) > 0 And Len(Coombobox_country_3.Selected.cp_name) > 0 And Len(Dropdown_dec_gender.Selected.cp_name) > 0 And Len(Dropdown_def_ethnicity.Selected.cp_name) > 0 And Len(Dropdown_def_ethnicity.Selected.cp_name) > 0 And Len(txtDeceasedOccupation_identification.Text) > 0 And Len(Dropdown_Maritalstatus.Selected.cp_name) > 0,
                            DisplayMode.Edit,
                            DisplayMode.Disabled
                        )
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =280
                    OnSelect: |-
                        =Set(
                            varPenInput,
                            PenInput3.Image
                        );
                        Set(gblLockBackButton,false);
                        If(
                            PenInput3.Image = varPenInput,
                            Set(gblLockBackButton,true);
                            UpdateContext({DateNow: Now()});
                            UpdateContext({hasBeenSigned: true})
                        )
                    Reset: =true
                    Visible: |-
                        =LookUp(
                            Contactoffline,
                            Key = Drpdn_incident_key_2.Selected.Key,
                            identificationsignature
                        ) = Blank()
                    Width: =545
                    X: =47
                    Y: =3005
                    ZIndex: =54

            Group6_2 As group:
                Height: =5
                Width: =5
                X: =20
                Y: =-1566
                ZIndex: =71

                rectContactMethods_2 As rectangle:
                    BorderColor: =RGBA(153, 153, 153, 1)
                    BorderThickness: =2
                    DisplayMode: =idetidisable
                    Fill: =If(!IsBlank(Txt_homeph_4.Text) Or !IsBlank(Txt_workphone_4.Text) Or !IsBlank(Txt_mobileph_4.Text) Or !IsBlank(Txt_mail_4.Text), Transparent,LightGoldenRodYellow)
                    Height: =538
                    Width: =545
                    X: =40
                    Y: =1418
                    ZIndex: =27

                Txt_homeph_4 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)  
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Homephone
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: |-
                        =//fillhomeph1
                        If(IsBlank(Self.Text),White,If(IsMatch(Self.Text,"^[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]$"),LightGreen,Red))
                    Height: =68
                    HintText: |-
                        ="###########"
                    MaxLength: =13
                    OnChange: =
                    OnSelect: =Set(validstart1,true)
                    Reset: =Allreset
                    Size: =21
                    VirtualKeyboardMode: =VirtualKeyboardMode.Numeric
                    Width: =490
                    X: =73
                    Y: =1498
                    ZIndex: =28

                Txt_mail_4 As text:
                    BorderColor: =RGBA(179, 179, 179, 1)
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).EMail
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    HintText: =""
                    OnChange: =
                    Reset: =Allreset
                    Size: =21
                    Width: =488
                    X: =75
                    Y: =1876
                    ZIndex: =29

                Txt_mobileph_4 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)  
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Mobile
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.Text),White,If(IsMatch(Self.Text,"^[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]$"),LightGreen,Red))
                    Height: =68
                    HintText: |-
                        ="###########"
                    MaxLength: =13
                    OnChange: =
                    Reset: =Allreset
                    Size: =21
                    Visible: =true    
                    Width: =488
                    X: =75
                    Y: =1749
                    ZIndex: =30

                Txt_workphone_4 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)  
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Workphone
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.Text),White,If(IsMatch(Self.Text,"^[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]$"),LightGreen,Red))
                    Height: =68
                    HintText: |-
                        ="###########"
                    MaxLength: =13
                    OnChange: =
                    Reset: =Allreset
                    Size: =21
                    Width: =488
                    X: =75
                    Y: =1618
                    ZIndex: =31

                Lbl_addcontactmethod_12 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Home Phone"
                    Width: =481
                    X: =75
                    Y: =1429
                    ZIndex: =32

                Lbl_addcontactmethod_13 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Work Phone"
                    Width: =481
                    X: =75
                    Y: =1561
                    ZIndex: =33

                Lbl_addcontactmethod_14 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Mobile Phone"
                    Width: =481
                    X: =75
                    Y: =1691
                    ZIndex: =34

                Lbl_addcontactmethod_15 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Email"
                    Width: =481
                    X: =75
                    Y: =1822
                    ZIndex: =35

            Group3 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =73

                Txt_forename_1 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)
                    Clear: =true
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Forename
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                    Height: =68
                    HintText: =""
                    HoverBorderColor: =RGBA(128, 128, 128, 1)
                    HoverFill: =RGBA(230, 230, 230, 1)
                    OnChange: =
                    Reset: =Allreset
                    Size: =21
                    Width: =545
                    X: =40
                    Y: =180
                    ZIndex: =2

                Label_dob_12 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Forename"
                    Width: =545
                    X: =40
                    Y: =125
                    ZIndex: =36

            Group6 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =73

                Txt_surname_1 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)
                    Clear: =true
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Surname
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                    Height: =68
                    HintText: =""
                    HoverBorderColor: =RGBA(128, 128, 128, 1)
                    HoverFill: =RGBA(230, 230, 230, 1)
                    OnChange: =
                    OnSelect: |-
                        =If(
                            Len(Txt_surname_1.Text) > 0,
                            UpdateContext({madcolA: Transparent}),
                            UpdateContext({madcolA: LightGoldenRodYellow})
                        );
                    Reset: =Allreset
                    Size: =21
                    Width: =545
                    X: =40
                    Y: =291
                    ZIndex: =3

                Label_dob_13 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="Surname"
                    Width: =545
                    X: =40
                    Y: =235
                    ZIndex: =37

            Group7 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =73

                Drpdn_title_2 As dropdown:
                    AllowEmptySelection: =true
                    BorderColor: =RGBA(128, 128, 128, 1)
                    ChevronBackground: =RGBA(128, 128, 128, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(230, 230, 230, 100), -20%)
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Titlename
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.SelectedText.Value),LightGoldenRodYellow,White) 
                    Height: =68
                    HoverFill: =RGBA(230, 230, 230, 1)
                    Items: =StaffTitleoffline
                    OnChange: |-
                        =If(Len(Drpdn_title_2.Selected.cp_name)>0,UpdateContext({madcolO:White}),UpdateContext({madcolO:LightGoldenRodYellow}))
                    OnSelect: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    PressedFill: =RGBA(230, 230, 230, 1)
                    Reset: =Allreset
                    SelectionFill: =RGBA(128, 128, 128, 1)
                    Size: =21
                    Width: =545
                    X: =40
                    Y: =70
                    ZIndex: =1

                Label_dob_6 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    OnSelect: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Size: =21
                    Text: ="Title"// & Drpdn_incident_key_2.Selected.IdentifierContactKey
                    Width: =545
                    X: =40
                    Y: =17
                    ZIndex: =23

            Group8 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =73

                Txt_housename_1 As text:
                    BorderColor: =RGBA(153, 153, 153, 1)
                    Default: =First(Search(Filter(Contactoffline,Key=Drpdn_incident_key_2.Selected.Key), "Identifier", "Contactrolename")).Housename
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =If(IsBlank(Self.Text),LightGoldenRodYellow,White)
                    Height: =68
                    HintText: =""
                    OnChange: |-
                        =If(
                            Len(Txt_housename_1.Text) > 0,
                            UpdateContext({madcolC: Transparent}),
                            UpdateContext({madcolC: LightGoldenRodYellow})
                        );
                    Reset: =Allreset
                    Size: =21
                    Width: =545
                    X: =40
                    Y: =541
                    ZIndex: =6

                Lbl_address_2 As label:
                    DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =68
                    Size: =21
                    Text: ="House Name and Number"
                    Width: =560
                    X: =40
                    Y: =494
                    ZIndex: =13

        DataCard4 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =100
            Width: =640
            X: =0
            Y: =0
            ZIndex: =2

            Drpdn_incident_key_2 As dropdown:
                BorderColor: =RGBA(128, 128, 128, 1)
                ChevronBackground: =RGBA(128, 128, 128, 1)
                ChevronHoverBackground: =ColorFade(RGBA(230, 230, 230, 100), -20%)
                Default: =Sudden_Primary_key
                DisplayMode: =DisplayMode.Disabled
                Height: =70
                HoverFill: =RGBA(230, 230, 230, 1)
                Items: |
                    =Filter('Sudden death offline',Key=Sudden_Primary_key).Key
                SelectionFill: =RGBA(128, 128, 128, 1)
                Size: =21
                Width: =545
                X: =40
                Y: =16
                ZIndex: =1

        DataCard5 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =319
            Width: =640
            X: =0
            Y: =1
            ZIndex: =3

            Label2_22 As label:
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =66
                Size: =21
                Text: |-
                    ="Able to complete formal identification of the deceased?
                    "
                Width: =560
                X: =40
                ZIndex: =1

            Radio_Identification_completion_1 As radio:
                BorderStyle: =BorderStyle.None
                Default: =LookUp('Sudden death offline',Key=Drpdn_incident_key_2.Selected.Key).'Formal identification'
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =If(IsBlank(Self.SelectedText.Value),LightGoldenRodYellow,White)
                Items: =["Yes","No"]
                Layout: =Layout.Horizontal
                OnChange: |-
                    =If(Len(Radio_Identification_completion_1.Selected.Value)>0,UpdateContext({madcolsxsd:White}),UpdateContext({madcolsxsd:LightGoldenRodYellow}));
                OnSelect: |-
                    =If(Len(Radio_Identification_completion_1.Selected.Value)>0,UpdateContext({madcolsxsd:White}),UpdateContext({madcolsxsd:LightGoldenRodYellow}))
                RadioBorderColor: =RGBA(128, 128, 128, 1)
                Reset: =Allreset
                Size: =21
                Width: =336
                X: =40
                Y: =89
                ZIndex: =2

            Txt_steps_to_identify_1 As text:
                BorderColor: =RGBA(153, 153, 153, 1)
                Default: =LookUp('Sudden death offline',Key=Drpdn_incident_key_2.Selected.Key).'Formal Identification steps'
                DisplayMode: =If(hasBeenSigned = true,DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =MadcolNo
                Height: =100
                HintText: ="Steps taken to formally identify the deceased?"
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                HoverFill: =RGBA(230, 230, 230, 1)
                Mode: =TextMode.MultiLine
                OnChange: =If(!IsBlank(Txt_steps_to_identify_1.Text),Set(MadcolNo,White),Set(MadcolNo,LightGoldenRodYellow))
                OnSelect: =
                Reset: =Allreset
                Size: =21
                Visible: =If(Radio_Identification_completion_1.Selected.Value="No",true,false)
                Width: =545
                X: =45
                Y: =189
                ZIndex: =3

        DataCard6 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =93
            Width: =640
            X: =0
            Y: =3
            ZIndex: =4

    Icon_back_details_home_2 As icon.ArrowLeft:
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =If(gblLockBackButton = true, DisplayMode.Disabled, DisplayMode.Edit)
        Icon: =Icon.ArrowLeft
        OnSelect: =Navigate(Scr_home,UnCoverRight)
        X: =31
        Y: =13
        ZIndex: =4

    Icn_exit_Home_2 As icon.Cancel:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(255, 255, 255, 1)
        Icon: =Icon.Cancel
        OnSelect: =Exit()
        X: =576
        Y: =13
        ZIndex: =5

    Btn_add_details_3 As button:
        DisplayMode: |-
            =If(
                And(
                    (Radio_Identification_completion_1.Selected.Value = "Yes" And !IsBlank(Drpdn_title_2.Selected.cp_name) And !IsBlank(Txt_forename_1.Text) And !IsBlank(Txt_surname_1.Text) And !IsBlank(Text(DatePicker_dob_1.SelectedDate)) And !IsBlank(Txt_housename_1.Text) And !IsBlank(Txt_address_1.Text) And !IsBlank(Txt_town_2.Text) And !IsBlank(Txt_county_2.Text) And !IsBlank(Txt_pobox_2.Text) And !IsBlank(Coombobox_country_2.Selected.cp_name) And (!IsBlank(Txt_homeph_4.Text) Or !IsBlank(Txt_workphone_4.Text) Or !IsBlank(Txt_mobileph_4.Text) Or !IsBlank(Txt_mail_4.Text)) And !IsBlank(Drpdn_pref_contact_method_1.Selected.cp_name) And !IsBlank(Radio_retired_1.Selected.Value) And !IsBlank(Txt_deceased_relathionship_duration_1.Text) And !IsBlank(Txt_relationship_deceased_1.Text) And !IsBlank(Txt_relationship_location_id)
                //And varInitialPenInput <> varPenInput 
            And Len(Txt_Deceased_detailsforename.Text) > 0 And Len(Txt_Deceased_details_surname.Text) > 0 And Len(Text(Datepicker_Deceased_details_dob.SelectedDate)) > 0 And Len(Txt_Deceased_details_address.Text) > 0 And Len(Txt_Deceased_details_housename.Text) > 0 And Len(Txt_Deceased_details_town.Text) > 0 And Len(Txt_Deceased_details_county.Text) > 0 And Len(Txt_Deceased_details_pobox.Text) > 0 And Len(Coombobox_country_3.Selected.cp_name) > 0 And Len(Dropdown_dec_gender.Selected.cp_name) > 0 And Len(Dropdown_def_ethnicity.Selected.cp_name) > 0 And Len(Dropdown_def_ethnicity.Selected.cp_name) > 0 And Len(txtDeceasedOccupation.Text) > 0 And Len(Dropdown_Maritalstatus.Selected.cp_name) > 0) Or Radio_Identification_completion_1.Selected.Value = "No",
                    LookUp(
                        Contactoffline,
                        Key = Drpdn_incident_key_2.Selected.Key And LookUp(
                            'Sudden death offline',
                            Key = Drpdn_incident_key_2.Selected.Key
                        ).IdentifierContactKey in ContactKey
                    ).identificationsignature = Blank()
                ),
                DisplayMode.Edit,
                DisplayMode.Disabled
            )
        Fill: =RGBA(153, 153, 153, 1)
        Height: =70
        HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
        OnSelect: |-
            =Set(
                gblLockBackButton,
                false
            );
            UpdateIf(
                'Sudden death offline',
                Key = Drpdn_incident_key_2.Selected.Key,
                {
                    'Next of kin informed': Radio_next_of_kin.Selected.Value,
                    'Formal identification': Radio_Identification_completion_1.Selected.Value,
                    'Formal Identification steps': Txt_steps_to_identify_1.Text
                }
            );
            If(
                Radio_Identification_completion_1.SelectedText.Value = "Yes",
                UpdateIf(
                    Contactoffline,
                    Key = Drpdn_incident_key_2.Selected.Key And ContactKey = GUID(
                        LookUp(
                            'Sudden death offline',
                            Key = Drpdn_incident_key_2.Selected.Key
                        ).IdentifierContactKey
                    )
                    /*
                    And !IsBlank(
                        First(
                            Search(
                                Filter(
                                    Contactoffline,
                                    Key = Drpdn_incident_key_2.Selected.Key
                                ),
                                "Identifier",
                                "Contactrolename"
                            )
                        )
                    )*/
            ,
                    {
                        Title: Drpdn_title_2.Selected.cp_lookupvalueid,
                        Forename: Txt_forename_1.Text,
                        Surname: Txt_surname_1.Text,
                        Fullname: Txt_surname_1.Text & " " & Txt_forename_1.Text,
                        Housename: Txt_housename_1.Text,
                        Housenumber: Txt_houseno_1.Text,
                        Address1: Txt_address_1.Text,
                        District: Txt_district_2.Text,
                        Town: Txt_town_2.Text,
                        County: Txt_county_2.Text,
                        pcode: Txt_pobox_2.Text,
                        'Date of Birth': DatePicker_dob_1.SelectedDate,
                        Country: Coombobox_country_2.Selected.cp_name,
                        Countryid: cboAddPersonCountry.Selected.cp_lookupvalueid,
                        Homephone: Txt_homeph_4.Text,
                        Workphone: Txt_workphone_4.Text,
                        Mobile: Txt_mobileph_4.Text,
                        EMail: Txt_mail_4.Text,
                        Preferedcontactmethod: Drpdn_pref_contact_method_1.Selected.cp_lookupvalueid,
                        Preferedcontactmethodname: Drpdn_pref_contact_method_1.Selected.cp_name,
                        Retired: Radio_retired_1.Selected.Value,
                        Formeroccupation: txtDeceasedOccupation_identification.Text,
                        Additionalinfo: Txt_additional_information_1.Text,
                        Deceasedrelationshipduration: Txt_deceased_relathionship_duration_1.Text,
                        Deceasedrelathionship: Txt_relationship_deceased_1.Text,
                        identificationsignature: If(
                            hasBeenSigned = true,
                            PenInput3.Image,
                            Blank()
                        ),
                        signdate: DateNow,
                        Locationofid: Txt_relationship_location_id.Text
                    }
                );
                UpdateIf(
                    Contactoffline,
                    Key = Drpdn_incident_key_2.Selected.Key And Contactrolename = "Deceased",
                    {
                        identificationsignature: If(
                            hasBeenSigned = true,
                            PenInput3.Image,
                            Blank()
                        )
                    }
                );
                If(
                    IsEmpty(
                        Filter(
                            Contactoffline,
                            Key = Drpdn_incident_key_2.Selected.Key And IsMatch(
                                Contactrolename,
                                "Identifier",
                                MatchOptions.Contains
                            )
                        )
                    ) And Radio_Identification_completion_1.SelectedText.Value = "Yes",
                    UpdateContext({newContactKey: GUID()});
                    Collect(
                        Contactoffline,
                        {
                            Key: Drpdn_incident_key_2.Selected.Key,
                            ContactKey: newContactKey,
                            Title: Drpdn_title_2.Selected.cp_lookupvalueid,
                            Forename: Txt_forename_1.Text,
                            Surname: Txt_surname_1.Text,
                            Fullname: Txt_surname_1.Text & " " & Txt_forename_1.Text,
                            Housename: Txt_housename_1.Text,
                            Housenumber: Txt_houseno_1.Text,
                            Address1: Txt_address_1.Text,
                            District: Txt_district_2.Text,
                            Town: Txt_town_2.Text,
                            County: Txt_county_2.Text,
                            pcode: Txt_pobox_2.Text,
                            'Date of Birth': DatePicker_dob_1.SelectedDate,
                            Country: Coombobox_country_2.Selected.cp_name,
                            Homephone: Txt_homeph_4.Text,
                            Workphone: Txt_workphone_4.Text,
                            Mobile: Txt_mobileph_4.Text,
                            EMail: Txt_mail_4.Text,
                            Preferedcontactmethod: Drpdn_pref_contact_method_1.Selected.cp_lookupvalueid,
                            Preferedcontactmethodname: Drpdn_pref_contact_method_1.Selected.cp_name,
                            Retired: Radio_retired_1.Selected.Value,
                            Formeroccupation: txtDeceasedOccupation_identification.Text,
                            Additionalinfo: Txt_additional_information_1.Text,
                            Deceasedrelationshipduration: Txt_deceased_relathionship_duration_1.Text,
                            Deceasedrelathionship: Txt_relationship_deceased_1.Text,
                            identificationsignature: If(
                                hasBeenSigned = true,
                                PenInput3.Image,
                                Blank()
                            ),
                            signdate: Now(),
                            Contactrole: LookUp(
                                ContactRoleoffline,
                                cp_name = "Identifier"
                            ).cp_contactroletypeid,
                            Contactrolename: LookUp(
                                ContactRoleoffline,
                                cp_name = "Identifier"
                            ).cp_name,
                            Locationofid: Txt_relationship_location_id.Text
                        }
                    );
                    Patch(
                        'Sudden death offline',
                        LookUp(
                            'Sudden death offline',
                            Key = Drpdn_incident_key_2.Selected.Key
                        ),
                        {IdentifierContactKey: Text(newContactKey)}
                    );
                );
                
            );
            UpdateContext(
                {
                    rec: LookUp(
                        Contactoffline,
                        Key = Sudden_Primary_key And ContactKey = GUID(
                            LookUp(
                                'Sudden death offline',
                                Key = Sudden_Primary_key
                            ).IdentifierContactKey
                        )
                    )
                }
            );
            UpdateContext(
                {
                    suddenDeathRec: LookUp(
                        'Sudden death offline',
                        Key = Sudden_Primary_key
                    )
                }
            );
            UpdateIf(
                'Sudden death offline',
                Key = Sudden_Primary_key,
                {
                    identificationValid: Or(
                        And(
                            suddenDeathRec.'Formal identification' = "No",
                            !IsBlank(Txt_steps_to_identify_1.Text)
                        ),
                        And(
                            suddenDeathRec.'Formal identification' = "Yes",
                            !IsBlank(rec.Title),
                            !IsBlank(rec.Forename),
                            !IsBlank(rec.Surname),
                            !IsBlank(rec.'Date of Birth'),
                            !IsBlank(rec.Housename),
                            !IsBlank(rec.Address1),
                            !IsBlank(rec.Town),
                            !IsBlank(rec.County),
                            !IsBlank(rec.pcode),
                            Or(
                                !IsBlank(rec.Homephone),
                                !IsBlank(rec.Mobile),
                                !IsBlank(rec.Workphone),
                                !IsBlank(rec.EMail)
                            ),
                            //!IsBlank(rec.Preferedcontactmethod),
                            !IsBlank(rec.identificationsignature),
                            !IsBlank(rec.Deceasedrelathionship),
                            !IsBlank(rec.Deceasedrelationshipduration),
                            !IsBlank(rec.Locationofid)
                        )
                    )
                }
            );
            Collect(
                UsedContactRoles,
                {
                    Key: Drpdn_incident_key_5.Selected.Key,
                    Role: "Identifier"
                }
            );
            SaveData(
                Contactoffline,
                "Contactoffline"
            );
            SaveData(
                'Sudden death offline',
                "Sudden death offline"
            );
            Navigate(
                Scr_home,
                UnCoverRight
            )
        Size: =24
        Text: |-
            =If(
                Len(
                    LookUp(
                        Contactoffline,
                        IsMatch(Contactrolename ,"Identifier",MatchOptions.Contains) And Key = Dropdown_Deceased_details_key.Selected.Key
                    ).Contactrolename
                ) > 0,
                "Update Identifier",
                "Add Identifier"
            )
        Width: =545
        X: =47
        Y: =1056
        ZIndex: =6

